<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Matrix Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --primary-dark: #5649c0;
            --secondary: #00cec9;
            --accent: #fd79a8;
            --dark: #2d3436;
            --light: #f5f6fa;
            --success: #00b894;
            --error: #d63031;
            --warning: #fdcb6e;
            --matrix-a: #6c5ce7;
            --matrix-b: #00cec9;
            --matrix-result: #fd79a8;
        }

        .chatbot-icon {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 60px;
            height: 60px;
            background: transparent;
            border: none;
            cursor: pointer;
            z-index: 9999;
            transition: transform 0.3s ease;
            padding: 0;
            margin: 0;
        }

        .chatbot-icon:hover {
            transform: scale(1.1);
        }

        .chatbot-icon img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            min-height: 100vh;
            background: var(--dark);
            color: var(--light);
            overflow-x: hidden;
            position: relative;
        }

        /* Enhanced Animated Background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
            background: linear-gradient(-45deg, #2d3436, #1e272e, #2d3436, #1e272e);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            pointer-events: none;
            animation: float linear infinite;
            opacity: 0;
        }

        .particle:nth-child(3n+1) {
            background: rgba(108, 92, 231, 0.3); /* Primary color */
        }

        .particle:nth-child(3n+2) {
            background: rgba(0, 206, 201, 0.3); /* Secondary color */
        }

        .particle:nth-child(3n+3) {
            background: rgba(253, 121, 168, 0.3); /* Accent color */
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) scale(0.5);
                opacity: 0;
            }
            10% {
                opacity: 0.5;
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(-20vh) scale(1);
                opacity: 0;
            }
        }

        .grid-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
            linear-gradient(90deg, rgba(45, 52, 54, 0.8) 1px, transparent 1px),
            linear-gradient(rgba(45, 52, 54, 0.8) 1px, transparent 1px);
            background-size: 40px 40px;
            z-index: -1;
            opacity: 0.3;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 0.5rem;
            animation: fadeInDown 0.8s;
        }

        .header p {
            color: rgba(255, 255, 255, 0.7);
            font-weight: 300;
            font-size: 1.1rem;
            animation: fadeIn 1s;
        }

        .calculator {
            background: rgba(45, 52, 54, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s;
        }

        .calculator:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
            transform: translateY(-5px);
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-bottom: 2rem;
            justify-content: center;
        }

        .dimension-control {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            background: rgba(0, 0, 0, 0.2);
            padding: 0.8rem 1.2rem;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .dimension-control:hover {
            background: rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }

        .dimension-control label {
            font-weight: 500;
            color: rgba(255, 255, 255, 0.8);
            white-space: nowrap;
        }

        .dimension-control input {
            width: 60px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 0.5rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s;
        }

        .dimension-control input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(108, 92, 231, 0.3);
        }

        .matrix-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
        }

        .matrix {
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.5s;
        }

        .matrix h3 {
            margin-bottom: 1rem;
            font-weight: 600;
            position: relative;
            padding-bottom: 0.5rem;
        }

        #matrixA h3 {
            color: var(--matrix-a);
        }

        #matrixB h3 {
            color: var(--matrix-b);
        }

        .matrix h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, currentColor, transparent);
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.4s ease;
        }

        .matrix:hover h3::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .matrix-input {
            display: grid;
            gap: 0.5rem;
            padding: 1.5rem;
            position: relative;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .matrix-input input {
            width: 70px;
            height: 50px;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .matrix-input input:focus {
            outline: none;
            border-color: currentColor;
            box-shadow: 0 0 0 2px rgba(108, 92, 231, 0.3);
            transform: scale(1.05);
        }

        #matrixA .matrix-input input {
            border-color: var(--matrix-a);
        }

        #matrixB .matrix-input input {
            border-color: var(--matrix-b);
        }

        .matrix-bracket {
            position: absolute;
            height: calc(100% - 30px);
            width: 20px;
            top: 15px;
            pointer-events: none;
            border-radius: 8px;
            border: 2px solid;
            opacity: 0.7;
        }

        .left-bracket {
            left: 10px;
            border-right: none;
        }

        .right-bracket {
            right: 10px;
            border-left: none;
        }

        #matrixA .matrix-bracket {
            border-color: var(--matrix-a);
        }

        #matrixB .matrix-bracket {
            border-color: var(--matrix-b);
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-secondary:hover {
            background: rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .btn-accent {
            background: var(--accent);
        }

        .btn-accent:hover {
            background: #fc5d9d;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .operations {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .operation-btn {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            min-width: 120px;
        }

        .operation-btn:hover {
            color: white;
        }

        .operation-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 5px 15px rgba(108, 92, 231, 0.4);
        }

        .operation-icon {
            font-weight: 700;
        }

        .result-container {
            margin-top: 1.5rem;
            opacity: 0;
            height: 0;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        .result-container.show {
            opacity: 1;
            height: auto;
        }

        .result-title {
            color: var(--matrix-result);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .result-matrix {
            display: inline-grid;
            gap: 0.8rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid var(--matrix-result);
            margin-top: 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(253, 121, 168, 0.4);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(253, 121, 168, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(253, 121, 168, 0);
            }
        }

        .result-value {
            padding: 0.8rem 1rem;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--matrix-result);
            border-radius: 8px;
            text-align: center;
            min-width: 70px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .result-value:hover {
            transform: scale(1.05);
            background: rgba(253, 121, 168, 0.1);
        }

        .message {
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            font-weight: 500;
            animation: fadeIn 0.5s;
        }

        .error {
            background: rgba(214, 48, 49, 0.2);
            border: 1px solid var(--error);
            color: var(--error);
        }

        .success {
            background: rgba(0, 184, 148, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .dimension-control {
                width: 100%;
                justify-content: space-between;
            }
            
            .matrix-container {
                flex-direction: column;
                align-items: center;
                max-height: none;
            }
            
            .matrix-input input {
                width: 60px;
                height: 45px;
            }
            
            .operations {
                gap: 0.5rem;
            }
            
            .operation-btn {
                min-width: calc(50% - 0.5rem);
                padding: 0.6rem 0.5rem;
                font-size: 0.9rem;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes floatMatrix {
            0% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
            100% {
                transform: translateY(0px);
            }
        }

        .matrix {
            animation: floatMatrix 6s ease-in-out infinite;
        }

        #matrixB {
            animation-delay: 0.5s;
        }
    </style>
</head>
<body>
    <button class="chatbot-icon" id="chatbotIcon">
        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIwIDJINEMyLjkgMiAyIDIuOSAyIDR2MTJjMCAxLjEuOSAyIDIgMmgxNGw0IDRWNGMwLTEuMS0uOS0yLTItMnptLTIgMTJINnYtMmgxMnYyem0wLTNINlY5aDEydjJ6bTAtM0g2VjZoMTJ2MnoiIGZpbGw9IiMzYTg2ZmYiLz48L3N2Zz4=" alt="Chatbot">
    </button>
    <div class="bg-animation"></div>
    <div class="floating-particles" id="particles"></div>
    <div class="grid-lines"></div>
    <div class="container">
        <header class="header">
            <h1 class="animate__animated animate__fadeInDown">Quantum Matrix Calculator</h1>
            <p class="animate__animated animate__fadeIn">Perform advanced matrix operations with elegance</p>
        </header>

        <main class="calculator animate__animated animate__fadeInUp">
            <div class="controls">
                <div class="dimension-control animate__animated animate__fadeInLeft">
                    <label for="rowsA">Rows (A):</label>
                    <input type="number" id="rowsA" min="1" max="6" value="2">
                </div>
                <div class="dimension-control animate__animated animate__fadeInLeft animate__delay-1s">
                    <label for="colsA">Columns (A):</label>
                    <input type="number" id="colsA" min="1" max="6" value="2">
                </div>
                <div class="dimension-control animate__animated animate__fadeInRight animate__delay-1s" id="matrixBDimensions">
                    <label for="rowsB">Rows (B):</label>
                    <input type="number" id="rowsB" min="1" max="6" value="2">
                    <label for="colsB">Columns (B):</label>
                    <input type="number" id="colsB" min="1" max="6" value="2">
                </div>
                <button id="updateMatrices" class="btn btn-secondary animate__animated animate__fadeIn animate__delay-2s">
                    <i class="fas fa-sync-alt"></i> Update
                </button>
            </div>
            
            <div class="matrix-container">
                <div class="matrix" id="matrixA">
                    <h3>Matrix A</h3>
                    <div class="matrix-input">
                        <div class="matrix-bracket left-bracket"></div>
                        <div class="matrix-bracket right-bracket"></div>
                    </div>
                </div>
                
                <div class="matrix" id="matrixB">
                    <h3>Matrix B</h3>
                    <div class="matrix-input">
                        <div class="matrix-bracket left-bracket"></div>
                        <div class="matrix-bracket right-bracket"></div>
                    </div>
                </div>
            </div>
            
            <div class="operations">
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-3s" data-operation="add">
                    <span class="operation-icon">+</span> Addition
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-3s" data-operation="subtract">
                    <span class="operation-icon">-</span> Subtraction
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-4s" data-operation="multiply">
                    <span class="operation-icon">×</span> Multiplication
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-4s" data-operation="determinant">
                    <span class="operation-icon">|A|</span> Determinant
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-5s" data-operation="inverse">
                    <span class="operation-icon">A⁻¹</span> Inverse
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-5s" data-operation="transpose">
                    <span class="operation-icon">Aᵀ</span> Transpose
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-6s" data-operation="eigenvalues">
                    <span class="operation-icon">λ</span> Eigenvalues
                </button>
                <button class="operation-btn animate__animated animate__fadeIn animate__delay-6s" data-operation="rank">
                    <span class="operation-icon">rank</span> Rank
                </button>
                
            </div>
            
            <div class="text-center">
                <button id="calculateBtn" class="btn btn-accent animate__animated animate__fadeIn animate__delay-8s">
                    <i class="fas fa-calculator"></i> Calculate
                </button>
            </div>
            
            <div class="result-container" id="resultContainer">
                <h3 class="result-title">Result</h3>
                <div id="result"></div>
                <div id="error" class="message error"></div>
                <div id="success" class="message success"></div>
            </div>
        </main>
    </div>

    <!-- Font Awesome for icons -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const rowsAInput = document.getElementById('rowsA');
            const colsAInput = document.getElementById('colsA');
            const rowsBInput = document.getElementById('rowsB');
            const colsBInput = document.getElementById('colsB');
            const updateBtn = document.getElementById('updateMatrices');
            const matrixA = document.getElementById('matrixA').querySelector('.matrix-input');
            const matrixB = document.getElementById('matrixB').querySelector('.matrix-input');
            const operationBtns = document.querySelectorAll('.operation-btn');
            const calculateBtn = document.getElementById('calculateBtn');
            const resultDiv = document.getElementById('result');
            const errorDiv = document.getElementById('error');
            const successDiv = document.getElementById('success');
            const matrixBDimensions = document.getElementById('matrixBDimensions');
            const resultContainer = document.getElementById('resultContainer');
            const bgAnimation = document.getElementById('bgAnimation');
            
            let selectedOperation = null;
           
            
            // Create animated background particles
            function createParticles() {
                const container = document.getElementById('particles');
                const particleCount = Math.floor(window.innerWidth / 5);
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('particle');
                    
                    // Random size between 2px and 8px
                    const size = Math.random() * 6 + 2;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    
                    // Random position
                    particle.style.left = `${Math.random() * 100}%`;
                    
                    // Random animation duration (15s to 30s) and delay (0s to 15s)
                    const duration = Math.random() * 15 + 15;
                    const delay = Math.random() * 15;
                    particle.style.animationDuration = `${duration}s`;
                    particle.style.animationDelay = `${delay}s`;
                    
                    // Random movement path
                    const moveX = (Math.random() - 0.5) * 4;
                    particle.style.setProperty('--move-x', moveX);
                    
                    // Random blur effect
                    const blur = Math.random() * 3;
                    particle.style.filter = `blur(${blur}px)`;
                    
                    container.appendChild(particle);
                }
            }

            // Initialize particles
            createParticles();

            // Recreate particles on resize
            window.addEventListener('resize', function() {
                const container = document.getElementById('particles');
                container.innerHTML = '';
                createParticles();
            });
            
            // Initialize matrices with animation
            function createMatrixInput(container, rows, cols, color) {
                container.innerHTML = '';
                container.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
                
                // Add bracket elements back
                const leftBracket = document.createElement('div');
                leftBracket.className = 'matrix-bracket left-bracket';
                container.appendChild(leftBracket);
                
                // Create input cells with animation
                for (let i = 0; i < rows; i++) {
                    for (let j = 0; j < cols; j++) {
                        const input = document.createElement('input');
                        input.type = 'number';
                        input.value = i === j ? '1' : '0';
                        input.dataset.row = i;
                        input.dataset.col = j;
                        input.style.opacity = '0';
                        input.style.transform = 'scale(0.5)';
                        container.appendChild(input);
                        
                        // Animate each cell with a delay
                        setTimeout(() => {
                            input.style.transition = 'all 0.3s ease-out';
                            input.style.opacity = '1';
                            input.style.transform = 'scale(1)';
                        }, (i * cols + j) * 50);
                    }
                }
                
                // Add right bracket
                const rightBracket = document.createElement('div');
                rightBracket.className = 'matrix-bracket right-bracket';
                container.appendChild(rightBracket);
            }
            
            function updateMatrices() {
                const rowsA = parseInt(rowsAInput.value);
                const colsA = parseInt(colsAInput.value);
                const rowsB = parseInt(rowsBInput.value);
                const colsB = parseInt(colsBInput.value);
                
                // Validate dimensions
                if (rowsA < 1 || colsA < 1 || rowsB < 1 || colsB < 1 || 
                    rowsA > 6 || colsA > 6 || rowsB > 6 || colsB > 6) {
                    showError('Matrix dimensions must be between 1 and 6');
                    return;
                }
                
                // Animate out old matrices
                matrixA.style.transform = 'scale(0.8)';
                matrixA.style.opacity = '0';
                matrixB.style.transform = 'scale(0.8)';
                matrixB.style.opacity = '0';
                
                setTimeout(() => {
                    createMatrixInput(matrixA, rowsA, colsA, 'var(--matrix-a)');
                    createMatrixInput(matrixB, rowsB, colsB, 'var(--matrix-b)');
                    
                    // Animate in new matrices
                    matrixA.style.transition = 'all 0.3s ease-out';
                    matrixB.style.transition = 'all 0.3s ease-out';
                    matrixA.style.transform = 'scale(1)';
                    matrixA.style.opacity = '1';
                    matrixB.style.transform = 'scale(1)';
                    matrixB.style.opacity = '1';
                }, 300);
                
                // Reset selection when dimensions change
                selectedOperation = null;
                operationBtns.forEach(btn => btn.classList.remove('active'));
                clearMessages();
                resultDiv.innerHTML = '';
                resultContainer.classList.remove('show');
            }
            
            // Operation selection with animation
            operationBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (selectedOperation === this.dataset.operation) return;
                    
                    selectedOperation = this.dataset.operation;
                    operationBtns.forEach(b => {
                        b.classList.remove('active');
                        b.style.transform = 'translateY(0)';
                    });
                    this.classList.add('active');
                    
                    // Add bounce animation to selected button
                    this.style.transform = 'translateY(-5px)';
                    setTimeout(() => {
                        this.style.transform = 'translateY(-2px)';
                    }, 150);
                    
                    clearMessages();
                    
                    // Special handling for different operations
                    if (['determinant', 'inverse', 'transpose', 'eigenvalues', 'rank', 'power'].includes(selectedOperation)) {
                        document.getElementById('matrixB').style.display = 'none';
                        matrixBDimensions.style.display = 'none';
                        
                        if (selectedOperation === 'scalarMultiply') {
                            promptForScalar();
                        } else if (selectedOperation === 'power') {
                            promptForPower();
                        }
                    } else {
                        document.getElementById('matrixB').style.display = '';
                        matrixBDimensions.style.display = '';
                        document.getElementById('matrixB').classList.add('animate__animated', 'animate__fadeIn');
                    }
                });
            });
            
            function promptForScalar() {
                const value = prompt("Enter scalar value:", "1");
                if (value !== null) {
                    scalarValue = parseFloat(value) || 1;
                }
            }
            
            function promptForPower() {
                const value = prompt("Enter power (positive integer):", "2");
                if (value !== null) {
                    powerValue = Math.max(1, Math.min(parseInt(value) || 2, 5)); // Limit to 1-5 for demo
                }
            }
            
            // Calculate button with animation
            calculateBtn.addEventListener('click', function() {
                if (!selectedOperation) {
                    showError('Please select an operation first');
                    return;
                }
                
                // Add loading animation to button
                const originalHtml = this.innerHTML;
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Calculating...';
                this.disabled = true;
                
                clearMessages();
                resultDiv.innerHTML = '';
                
                try {
                    const rowsA = parseInt(rowsAInput.value);
                    const colsA = parseInt(colsAInput.value);
                    
                    // Get matrix A values
                    const matrixAValues = [];
                    for (let i = 0; i < rowsA; i++) {
                        const row = [];
                        for (let j = 0; j < colsA; j++) {
                            const input = document.querySelector(`#matrixA input[data-row="${i}"][data-col="${j}"]`);
                            const val = parseFloat(input.value);
                            if (isNaN(val)) {
                                throw new Error(`Invalid value at Matrix A [${i+1},${j+1}]`);
                            }
                            row.push(val);
                        }
                        matrixAValues.push(row);
                    }
                    
                    // Get matrix B values if needed
                    let matrixBValues = null;
                    if (['add', 'subtract', 'multiply'].includes(selectedOperation)) {
                        const rowsB = parseInt(rowsBInput.value);
                        const colsB = parseInt(colsBInput.value);
                        
                        matrixBValues = [];
                        for (let i = 0; i < rowsB; i++) {
                            const row = [];
                            for (let j = 0; j < colsB; j++) {
                                const input = document.querySelector(`#matrixB input[data-row="${i}"][data-col="${j}"]`);
                                const val = parseFloat(input.value);
                                if (isNaN(val)) {
                                    throw new Error(`Invalid value at Matrix B [${i+1},${j+1}]`);
                                }
                                row.push(val);
                            }
                            matrixBValues.push(row);
                        }
                    }
                    
                    // Simulate API call with timeout
                    setTimeout(() => {
                        try {
                            const result = performCalculation(selectedOperation, matrixAValues, matrixBValues);
                            displayResult(result);
                            showSuccess('Calculation completed successfully!');
                        } catch (error) {
                            showError(error.message);
                        } finally {
                            calculateBtn.innerHTML = originalHtml;
                            calculateBtn.disabled = false;
                        }
                    }, 800);
                    
                } catch (error) {
                    showError(error.message);
                    calculateBtn.innerHTML = originalHtml;
                    calculateBtn.disabled = false;
                }
            });
            
            // Matrix operation implementations
            function performCalculation(operation, matrixA, matrixB) {
                switch(operation) {
                    case 'add':
                        return addMatrices(matrixA, matrixB);
                    case 'subtract':
                        return subtractMatrices(matrixA, matrixB);
                    case 'multiply':
                        return multiplyMatrices(matrixA, matrixB);
                    case 'determinant':
                        return calculateDeterminant(matrixA);
                    case 'inverse':
                        return calculateInverse(matrixA);
                    case 'transpose':
                        return transposeMatrix(matrixA);
                    case 'eigenvalues':
                        return calculateEigenvalues(matrixA);
                    case 'rank':
                        return calculateRank(matrixA);
                    
                    default:
                        throw new Error('Unknown operation');
                }
            }
            
            // Matrix addition
            function addMatrices(matrixA, matrixB) {
                if (matrixA.length !== matrixB.length || matrixA[0].length !== matrixB[0].length) {
                    throw new Error('Matrices must have same dimensions for addition');
                }
                
                return matrixA.map((row, i) => 
                    row.map((val, j) => val + matrixB[i][j])
                );
            }
            
            // Matrix subtraction
            function subtractMatrices(matrixA, matrixB) {
                if (matrixA.length !== matrixB.length || matrixA[0].length !== matrixB[0].length) {
                    throw new Error('Matrices must have same dimensions for subtraction');
                }
                
                return matrixA.map((row, i) => 
                    row.map((val, j) => val - matrixB[i][j])
                );
            }
            
            // Matrix multiplication
            function multiplyMatrices(matrixA, matrixB) {
                if (matrixA[0].length !== matrixB.length) {
                    throw new Error('Columns of A must match rows of B for multiplication');
                }
                
                const result = new Array(matrixA.length).fill(0)
                    .map(() => new Array(matrixB[0].length).fill(0));
                
                for (let i = 0; i < matrixA.length; i++) {
                    for (let j = 0; j < matrixB[0].length; j++) {
                        for (let k = 0; k < matrixA[0].length; k++) {
                            result[i][j] += matrixA[i][k] * matrixB[k][j];
                        }
                    }
                }
                
                return result;
            }
            
            // Matrix determinant
            function calculateDeterminant(matrix) {
                if (matrix.length !== matrix[0].length) {
                    throw new Error('Matrix must be square to calculate determinant');
                }
                
                // For 1x1 matrix
                if (matrix.length === 1) {
                    return matrix[0][0];
                }
                
                // For 2x2 matrix
                if (matrix.length === 2) {
                    return matrix[0][0] * matrix[1][1] - matrix[0][1] * matrix[1][0];
                }
                
                // For 3x3 matrix (Sarrus rule)
                if (matrix.length === 3) {
                    const [a, b, c] = matrix[0];
                    const [d, e, f] = matrix[1];
                    const [g, h, i] = matrix[2];
                    
                    return a*e*i + b*f*g + c*d*h - c*e*g - b*d*i - a*f*h;
                }
                
                // For larger matrices (recursive Laplace expansion)
                let det = 0;
                for (let col = 0; col < matrix.length; col++) {
                    const minor = matrix.slice(1).map(row => 
                        row.filter((_, i) => i !== col)
                    );
                    const sign = col % 2 === 0 ? 1 : -1;
                    det += sign * matrix[0][col] * calculateDeterminant(minor);
                }
                
                return det;
            }
            
            // Matrix inverse
            function calculateInverse(matrix) {
                if (matrix.length !== matrix[0].length) {
                    throw new Error('Matrix must be square to calculate inverse');
                }
                
                const det = calculateDeterminant(matrix);
                if (det === 0) {
                    throw new Error('Matrix is not invertible (determinant is 0)');
                }
                
                // For 1x1 matrix
                if (matrix.length === 1) {
                    return [[1 / matrix[0][0]]];
                }
                
                // For 2x2 matrix
                if (matrix.length === 2) {
                    const [a, b] = matrix[0];
                    const [c, d] = matrix[1];
                    
                    return [
                        [d/det, -b/det],
                        [-c/det, a/det]
                    ];
                }
                
                // For larger matrices (using adjugate matrix)
                const adjugate = getAdjugateMatrix(matrix);
                return adjugate.map(row => 
                    row.map(val => val / det)
                );
            }
            
            // Helper function to get adjugate matrix
            function getAdjugateMatrix(matrix) {
                const cofactors = [];
                
                for (let i = 0; i < matrix.length; i++) {
                    const cofactorRow = [];
                    for (let j = 0; j < matrix.length; j++) {
                        const minor = matrix.filter((_, row) => row !== i)
                            .map(row => row.filter((_, col) => col !== j));
                        const sign = (i + j) % 2 === 0 ? 1 : -1;
                        cofactorRow.push(sign * calculateDeterminant(minor));
                    }
                    cofactors.push(cofactorRow);
                }
                
                // Transpose to get adjugate
                return cofactors[0].map((_, i) => 
                    cofactors.map(row => row[i])
                );
            }
            
            // Matrix transpose
            function transposeMatrix(matrix) {
                return matrix[0].map((_, i) => 
                    matrix.map(row => row[i])
                );
            }
            
            // Matrix eigenvalues (simplified for 2x2)
            function calculateEigenvalues(matrix) {
                if (matrix.length !== matrix[0].length) {
                    throw new Error('Matrix must be square to calculate eigenvalues');
                }

                // For 2x2 matrices, we can calculate directly
                if (matrix.length === 2) {
                    const a = matrix[0][0];
                    const b = matrix[0][1];
                    const c = matrix[1][0];
                    const d = matrix[1][1];
                    
                    // Calculate discriminant
                    const trace = a + d;
                    const det = a * d - b * c;
                    const discriminant = trace * trace - 4 * det;
                    
                    if (discriminant < 0) {
                        // Complex eigenvalues
                        const realPart = trace / 2;
                        const imagPart = Math.sqrt(-discriminant) / 2;
                        return [
                            `${realPart.toFixed(4)} + ${imagPart.toFixed(4)}i`,
                            `${realPart.toFixed(4)} - ${imagPart.toFixed(4)}i`
                        ];
                    } else {
                        // Real eigenvalues
                        const sqrtDisc = Math.sqrt(discriminant);
                        return [
                            ((trace + sqrtDisc) / 2).toFixed(4),
                            ((trace - sqrtDisc) / 2).toFixed(4)
                        ];
                    }
                }

                // For larger matrices, use power iteration to find dominant eigenvalue
                const maxIterations = 1000;
                const epsilon = 1e-10;
                
                // Start with a random vector
                let vector = Array(matrix.length).fill().map(() => Math.random());
                let eigenvalue = 0;
                let prevEigenvalue = 1;
                let iterations = 0;
                
                // Normalize the vector
                let norm = Math.sqrt(vector.reduce((sum, x) => sum + x * x, 0));
                vector = vector.map(x => x / norm);
                
                while (Math.abs(eigenvalue - prevEigenvalue) > epsilon && iterations < maxIterations) {
                    prevEigenvalue = eigenvalue;
                    
                    // Multiply matrix by vector
                    let newVector = Array(matrix.length).fill(0);
                    for (let i = 0; i < matrix.length; i++) {
                        for (let j = 0; j < matrix.length; j++) {
                            newVector[i] += matrix[i][j] * vector[j];
                        }
                    }
                    
                    // Calculate eigenvalue (Rayleigh quotient)
                    eigenvalue = 0;
                    for (let i = 0; i < matrix.length; i++) {
                        eigenvalue += vector[i] * newVector[i];
                    }
                    
                    // Normalize the new vector
                    norm = Math.sqrt(newVector.reduce((sum, x) => sum + x * x, 0));
                    vector = newVector.map(x => x / norm);
                    
                    iterations++;
                }
                
                // For simplicity, return just the dominant eigenvalue
                // In a full implementation, you'd find all eigenvalues
                return [`Dominant eigenvalue: ${eigenvalue.toFixed(4)}`];
            }

                
                // For larger matrices, return a simplified result
            
            
            // Matrix rank
            function calculateRank(matrix) {
                // Simplified implementation using row reduction
                let rank = 0;
                const rows = matrix.length;
                const cols = matrix[0].length;
                const tempMatrix = JSON.parse(JSON.stringify(matrix));
                
                for (let row = 0; row < rows; row++) {
                    // Find pivot
                    let pivot = tempMatrix[row][row];
                    if (pivot === 0) {
                        let found = false;
                        for (let i = row + 1; i < rows; i++) {
                            if (tempMatrix[i][row] !== 0) {
                                // Swap rows
                                [tempMatrix[row], tempMatrix[i]] = [tempMatrix[i], tempMatrix[row]];
                                pivot = tempMatrix[row][row];
                                found = true;
                                break;
                            }
                        }
                        if (!found) continue;
                    }
                    
                    // Eliminate this column in lower rows
                    for (let i = row + 1; i < rows; i++) {
                        const factor = tempMatrix[i][row] / pivot;
                        for (let j = row; j < cols; j++) {
                            tempMatrix[i][j] -= factor * tempMatrix[row][j];
                        }
                    }
                    
                    rank++;
                }
                
                return rank;
            }
            
            // Scalar multiplication
           
            
            // Matrix power
            
            
            // Display result with animation
            function displayResult(result) {
                resultDiv.innerHTML = '';
                resultContainer.classList.add('show');

                if (Array.isArray(result)) {
                    // Matrix result
                    const resultContainer = document.createElement('div');
                    
                    // Check if we're displaying eigenvalues (which might be strings)
                    if (typeof result[0] === 'string' && result[0].includes('eigenvalue')) {
                        const eigenList = document.createElement('div');
                        eigenList.style.textAlign = 'center';
                        result.forEach(eigenvalue => {
                            const eigenItem = document.createElement('div');
                            eigenItem.className = 'result-value';
                            eigenItem.textContent = eigenvalue;
                            eigenItem.style.margin = '10px auto';
                            eigenItem.style.display = 'inline-block';
                            eigenList.appendChild(eigenItem);
                        });
                        resultContainer.appendChild(eigenList);
                    } 
                    else if (!Array.isArray(result[0])) {
                        // Vector result
                        const resultMatrix = document.createElement('div');
                        resultMatrix.className = 'result-matrix';
                        resultMatrix.style.gridTemplateColumns = `repeat(${result.length}, 1fr)`;
                        
                        result.forEach((val, i) => {
                            const cell = document.createElement('div');
                            cell.className = 'result-value';
                            cell.textContent = typeof val === 'number' ? val.toFixed(4) : val;
                            cell.style.opacity = '0';
                            cell.style.transform = 'translateY(20px)';
                            cell.style.transitionDelay = `${i * 0.05}s`;
                            resultMatrix.appendChild(cell);
                        });
                        resultContainer.appendChild(resultMatrix);
                    } else {
                        // Matrix result
                        const resultMatrix = document.createElement('div');
                        resultMatrix.className = 'result-matrix';
                        resultMatrix.style.gridTemplateColumns = `repeat(${result[0].length}, 1fr)`;
                        
                        result.forEach((row, i) => {
                            row.forEach((val, j) => {
                                const cell = document.createElement('div');
                                cell.className = 'result-value';
                                cell.textContent = typeof val === 'number' ? val.toFixed(4) : val;
                                cell.style.opacity = '0';
                                cell.style.transform = 'translateY(20px)';
                                cell.style.transitionDelay = `${(i * row.length + j) * 0.05}s`;
                                resultMatrix.appendChild(cell);
                            });
                        });
                        resultContainer.appendChild(resultMatrix);
                    }
                    
                    resultDiv.appendChild(resultContainer);
                    
                    // Animate result
                    setTimeout(() => {
                        const cells = resultContainer.querySelectorAll('.result-value');
                        cells.forEach(cell => {
                            cell.style.opacity = '1';
                            cell.style.transform = 'translateY(0)';
                            cell.style.transition = 'all 0.3s ease-out';
                        });
                    }, 100);
                } else {
                    // Scalar result
                    const resultValue = document.createElement('div');
                    resultValue.className = 'result-value animate__animated animate__bounceIn';
                    resultValue.style.display = 'inline-block';
                    resultValue.style.marginTop = '10px';
                    resultValue.style.opacity = '0';
                    resultValue.textContent = typeof result === 'number' ? result.toFixed(4) : result;
                    resultDiv.appendChild(resultValue);
                    
                    // Animate scalar result
                    setTimeout(() => {
                        resultValue.style.opacity = '1';
                        resultValue.classList.add('animate__animated', 'animate__tada');
                    }, 100);
                }
            }
            
            // Helper functions
            function showError(message) {
                errorDiv.textContent = message;
                errorDiv.classList.remove('animate__animated', 'animate__shakeX');
                void errorDiv.offsetWidth; // Trigger reflow
                errorDiv.classList.add('animate__animated', 'animate__shakeX');
                successDiv.textContent = '';
            }
            
            function showSuccess(message) {
                successDiv.textContent = message;
                successDiv.classList.remove('animate__animated', 'animate__fadeIn');
                void successDiv.offsetWidth;
                successDiv.classList.add('animate__animated', 'animate__fadeIn');
                errorDiv.textContent = '';
            }
            
            function clearMessages() {
                errorDiv.textContent = '';
                successDiv.textContent = '';
            }
            
            // Initialize
            createParticles();
            updateMatrices();
            
            updateBtn.addEventListener('click', updateMatrices);
            
            // Add hover effect to matrix containers
            document.querySelectorAll('.matrix').forEach(matrix => {
                matrix.addEventListener('mouseenter', function() {
                    this.classList.add('animate__animated', 'animate__pulse');
                });
                
                matrix.addEventListener('mouseleave', function() {
                    this.classList.remove('animate__animated', 'animate__pulse');
                });
            });

            // Responsive adjustments
            window.addEventListener('resize', function() {
                // Recreate particles on resize
                bgAnimation.innerHTML = '';
                createParticles();
            });
        });
        document.getElementById('chatbotIcon').addEventListener('click', function() {
            // Set your desired popup dimensions
            const width = 400;
            const height = 600;
            
            // Calculate centered position
            const left = (window.screen.width - width) / 2;
            const top = (window.screen.height - height) / 2;
            
            // Define window features to enforce size
            const features = `
                width=${width},
                height=${height},
                left=${left},
                top=${top},
                resizable=yes,
                scrollbars=yes,
                toolbar=no,
                menubar=no,
                location=no,
                status=no
            `.replace(/\s+/g, '');
            
            // Open the popup
            const chatWindow = window.open('/bot', 'chatWindow', features);
            
            // Focus the window if it exists
            if (chatWindow) {
                chatWindow.focus();
            }
        });
    </script>
</body>
</html>